<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Comprar Cr√©ditos Masitaprex | Planes Ilimitados de Consulta</title>
    <meta name="description" content="Recargar cr√©ditos Masitaprex es tu pase a la informaci√≥n de √©lite. Adquiere planes ilimitados para consultas DNI, RUC y servicios premium con total estabilidad.">
    <meta name="keywords" content="planes masitaprex, comprar creditos masitaprex, recargar creditos masitaprex, suscripcion masitaprex, consultas ilimitadas peru" />
    <meta name="robots" content="index, follow">

    <meta property="og:title" content="Planes Masitaprex | Adquiere el Poder de la Informaci√≥n" />
    <meta property="og:description" content="No te detengas. Recarga cr√©ditos o activa tu plan ilimitado hoy mismo para acceder a nuestras APIs y herramientas exclusivas." />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://masitaprex.com/planes" />
    <meta property="og:image" content="https://cdn-icons-png.flaticon.com/128/747/747965.png" />
    <meta property="og:image:width" content="128" />
    <meta property="og:image:height" content="128" />

    <link rel="icon" type="image/png" href="https://cdn-icons-png.flaticon.com/128/747/747965.png">
    <link rel="shortcut icon" type="image/png" href="https://cdn-icons-png.flaticon.com/128/747/747965.png">
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/128/747/747965.png">

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        
        /* ===== FONDO 3D CON DIAMANTES FLOTANTES ===== */
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
            margin: 0;
            padding: 0;
            width: 100%;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Canvas de fondo para los diamantes */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle at 20% 30%, rgba(30, 64, 175, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(5, 150, 105, 0.1) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        /* Animaci√≥n de diamantes flotantes */
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }

        @keyframes float-slow {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-30px) rotate(360deg); }
        }

        /* Diamantes flotantes */
        .diamond {
            position: fixed;
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, rgba(30, 64, 175, 0.3), rgba(5, 150, 105, 0.3));
            clip-path: polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%);
            z-index: 0;
            pointer-events: none;
            opacity: 0.4;
        }

        .diamond:nth-child(1) {
            top: 10%;
            left: 10%;
            animation: float 6s ease-in-out infinite;
        }

        .diamond:nth-child(2) {
            top: 60%;
            left: 80%;
            width: 70px;
            height: 70px;
            animation: float-slow 8s ease-in-out infinite;
        }

        .diamond:nth-child(3) {
            top: 80%;
            left: 20%;
            width: 40px;
            height: 40px;
            animation: float 7s ease-in-out infinite 1s;
        }

        .diamond:nth-child(4) {
            top: 30%;
            left: 70%;
            width: 60px;
            height: 60px;
            animation: float-slow 9s ease-in-out infinite 2s;
        }

        .diamond:nth-child(5) {
            top: 50%;
            left: 50%;
            width: 55px;
            height: 55px;
            animation: float 7.5s ease-in-out infinite 1.5s;
        }

        /* ===== ESTILOS DEL MEN√ö LATERAL COMPLETO ===== */

        /* Overlay para el men√∫ lateral */
        #sidebar-overlay { 
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 50;
            opacity: 0;
            transition: opacity 0.3s ease;
            display: none;
        }

        #sidebar-overlay.opacity-100 {
            opacity: 1;
        }

        #sidebar-overlay.hidden {
            display: none;
        }

        /* Men√∫ lateral principal */
        #sidebar {
            position: fixed;
            top: 0;
            left: 0;
            height: 100%;
            width: 288px; /* w-72 = 288px */
            background: #000 !important; /* Fondo negro puro */
            color: #FFFFFF;
            z-index: 60;
            box-shadow: 0 24px 80px rgba(0, 0, 0, 0.55);
            overflow-y: auto;
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            transform: translateX(-100%);
            display: flex;
            flex-direction: column;
        }

        #sidebar.open {
            transform: translateX(0);
        }

        /* Encabezado del sidebar */
        .sidebar-header-bg {
            padding: 40px 24px;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            flex-shrink: 0;
        }

        /* Contenedor del icono del sidebar */
        .sidebar-header-bg > div:first-child {
            width: 72px;
            height: 72px;
            border-radius: 16px;
            margin-bottom: 12px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.4);
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #000;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .sidebar-header-bg img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .sidebar-header-bg h1, .sidebar-header-bg h2 {
            font-size: 1.5rem;
            font-weight: 800;
            margin-top: 8px;
            color: #FFFFFF !important;
            letter-spacing: -0.025em;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        /* Decoraci√≥n SVG en el encabezado */
        .sidebar-header-bg > div:last-child {
            position: absolute;
            top: 16px; /* top-4 = 16px */
            left: 16px; /* left-4 = 16px */
            opacity: 0.3;
        }

        /* Opciones del men√∫ */
        #sidebar nav {
            padding: 16px 0;
            flex-grow: 1;
        }

        #sidebar nav a {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 24px;
            color: rgba(255, 255, 255, 0.8) !important;
            transition: all 0.2s ease;
            text-decoration: none;
            border-left: 4px solid transparent;
            margin-bottom: 2px;
        }

        #sidebar nav a:hover {
            background-color: rgba(255, 255, 255, 0.08);
            color: #FFFFFF !important;
            border-left-color: #FF1F3D;
        }

        #sidebar nav a.active {
            background-color: rgba(255, 255, 255, 0.1);
            color: #FFFFFF !important;
            border-left-color: #FF1F3D;
            font-weight: 600;
        }

        /* Iconos del men√∫ */
        #sidebar nav i {
            width: 24px;
            height: 24px;
            stroke-width: 2;
            color: inherit;
            flex-shrink: 0;
        }

        /* Separaci√≥n para el bot√≥n de cerrar sesi√≥n */
        #sidebar nav a:last-child {
            margin-top: 48px; /* Aumentado de 32px a 48px para mayor distinci√≥n */
        }

        /* Estilos para el texto del men√∫ */
        #sidebar nav span {
            font-size: 1.125rem; /* text-lg = 18px */
        }

        /* Estilos responsivos */
        @media (max-width: 640px) {
            #sidebar {
                width: 280px;
            }
        }

        @media (max-width: 480px) {
            #sidebar {
                width: 100%;
                max-width: 300px;
            }
        }

        /* Ajustes para scrollbar en navegadores WebKit */
        #sidebar::-webkit-scrollbar {
            width: 6px;
        }

        #sidebar::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 3px;
        }

        #sidebar::-webkit-scrollbar-thumb {
            background: rgba(109, 91, 255, 0.5);
            border-radius: 3px;
        }

        #sidebar::-webkit-scrollbar-thumb:hover {
            background: rgba(109, 91, 255, 0.7);
        }

        /* Estilo para los iconos de la cabecera para que sean legibles y grandes */
        .header-icon {
            width: 1.75rem;
            height: 1.75rem;
            color: #ffffff;
        }

        /* Banner de compartir (Oculto por defecto) */  
        .banner {  
            width: 100%;  
            max-width: 500px;
            background: linear-gradient(to right, #00264D, #003366);  
            color: #FFFFFF;  
            position: fixed;  
            bottom: 0;  
            left: 50%;  
            transform: translateX(-50%);  
            padding: 30px;  
            border-top-left-radius: 15px;  
            border-top-right-radius: 15px;  
            box-shadow: 0px -5px 15px rgba(0,0,0,0.3);  
            display: none; /* Ocultamos el banner al inicio */  
            flex-direction: column;  
            align-items: center;  
            text-align: center;  
            z-index: 9999;  
        }  

        .banner-title {  
            font-size: 24px;  
            font-weight: bold;  
            margin-bottom: 15px;  
            color: #FF00FF;  
        }  

        .banner-description {  
            font-size: 18px;  
            line-height: 1.8;  
            color: #FFFFFF;  
            margin-bottom: 20px;  
        }  

        /* Botones del banner */  
        .cta-button, .close-modal {  
            width: 100%;  
            padding: 16px;  
            text-align: center;  
            text-decoration: none;  
            border-radius: 25px;  
            font-size: 18px;  
            font-weight: bold;  
            margin-bottom: 12px;  
            cursor: pointer;  
            transition: transform 0.2s ease-in-out;  
        }  

        .cta-button {  
            background: linear-gradient(to right, #2ECC71, #66CC99);  
            color: white;  
        }  

        .cta-button:hover {  
            transform: scale(1.08);  
        }  

        .close-modal {  
            background-color: red;  
            color: #FFFFFF;  
        }  

        .close-modal:hover {  
            background-color: darkred;  
            transform: scale(1.08);  
        }  

        /* Iconos del banner */  
        .banner-icon {  
            margin-right: 8px;  
            color: #FF00FF;  
        }

        /* =====================================================================
        CSS PRINCIPAL - REDISE√ëO PARA APP M√ìVIL (MANTENIDO)
        ===================================================================== */
        :root {
            /* Azul y Verde para el degradado */
            --color-blue: #1e40af; /* Azul oscuro fuerte */
            --color-green: #059669; /* Verde de √©xito/oferta */
            --primary-gradient: linear-gradient(90deg, var(--color-blue) 0%, var(--color-green) 100%);
            --secondary-accent: var(--color-green); 
            --text-dark: #1f2937; 
            --text-medium: #4b5563; 
            --text-light: #ffffff; 
            --card-bg: #ffffff; 
            --border-color: #e5e7eb; 
            --shadow-sm: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
            --mp-color: #009ee3;
            --flow-color: #21a36e; 
            --yape-color: #79128c;
        }

        .main-content-container {
            width: 100%;
            max-width: 100%;
            padding: 1rem;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }

        .app-card {
            background: var(--card-bg);
            border-radius: 1rem;
            padding: 1.5rem;
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
            text-align: center; 
            width: 100%;
            max-width: 100%;
        }
        
        .app-card.accent-border {
            border-left: 5px solid transparent;
            border-image: var(--primary-gradient) 1;
            padding-left: 1rem;
        }

        h2 {
            font-size: 1.6rem;
            font-weight: 700;
            margin-bottom: 1rem;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-align: center;
        }
        
        h3 {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--text-dark);
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 0.5rem;
            text-align: center;
        }
        
        .section-subtitle {
            font-size: 1.1rem;
            font-weight: 600;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            text-align: left; 
            justify-content: center;
        }
        
        .section-subtitle i {
            margin-right: 0.5rem;
            font-size: 1.3rem;
            color: var(--color-blue); 
        }
        
        .section-subtitle i.fa-receipt {
            color: var(--color-blue) !important;
        }

        .pricing-table {
            width: 100%;
            table-layout: auto; /* CAMBIO: de fixed a auto para distribuci√≥n din√°mica */
            border-collapse: separate; 
            border-spacing: 0;
            margin-top: 1rem;
            font-size: 0.9rem;
            text-align: center;
            overflow: hidden; 
            border-radius: 0.75rem;
            box-shadow: var(--shadow-sm);
            margin-left: auto;
            margin-right: auto;
        }
        
        .pricing-table th, .pricing-table td {
            padding: 0.5rem 0.3rem; 
            border-right: 1px solid #f3f4ff;
            border-bottom: 1px solid #f3f4f6;
            word-wrap: break-word; 
        }
        
        .pricing-table th {
            background: var(--primary-gradient);
            color: var(--text-light);
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.7em; 
            line-height: 1.2;
        }
        
        .pricing-table tr:nth-child(even) {
            background-color: #f9fafb; 
        }
        
        .pricing-table tr:last-child td {
            border-bottom: none;
        }
        
        .pricing-table td:last-child, .pricing-table th:last-child {
            border-right: none;
        }

        .pricing-table td strong {
            font-weight: 700;
            color: var(--secondary-accent);
        }
        
        .pricing-table tr.recommended-row td {
            background-color: #ecfdf5; 
            font-weight: 600;
        }
        
        .pricing-table tr.best-value-row td {
            background-color: #eff6ff; 
        }
        
        .instruction-list {
            list-style: none;
            padding-left: 0;
            margin-top: 0.5rem;
            text-align: left; 
            max-width: 100%; /* CAMBIO: de 400px a 100% */
            margin-left: auto;
            margin-right: auto;
        }
        
        .instruction-list li {
            margin-bottom: 0.75rem;
            padding-left: 1.5rem;
            position: relative;
            font-size: 0.95rem;
            color: var(--text-medium);
        }
        
        .instruction-list li strong {
            color: var(--text-dark);
        }
        
        .instruction-list li:before {
            content: attr(data-step);
            position: absolute;
            left: 0;
            top: 2px;
            width: 18px;
            height: 18px;
            background: var(--primary-gradient);
            color: var(--text-light);
            border-radius: 50%;
            text-align: center;
            line-height: 18px;
            font-size: 0.75rem;
            font-weight: 700;
        }
        
        /* ESTILO PARA LISTA DE VENTAJAS */
        .advantage-list {
            display: grid;
            grid-template-columns: 1fr 1fr; 
            gap: 0.75rem;
            margin-top: 1rem;
            text-align: left;
        }
        
        .advantage-item {
            background-color: #f3f4f6; 
            padding: 0.75rem;
            border-radius: 0.5rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            font-size: 0.85rem;
            font-weight: 500;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-sm);
        }
        
        .advantage-item i {
            font-size: 1.5rem;
            margin-bottom: 0.25rem;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .info-box {
            background-color: #e0f2fe; 
            border: 1px solid #7dd3fc; 
            border-radius: 0.6rem;
            padding: 1rem;
            margin-bottom: 1.5rem;
            color: var(--color-blue); 
            font-size: 0.95rem;
            font-weight: 500;
            text-align: left; 
            max-width: 100%; /* CAMBIO: de 400px a 100% */
            margin-left: auto;
            margin-right: auto;
        }
        
        .warning-box {
            background-color: #fef3c7; 
            border: 1px solid #fbbf24;
            border-left: 5px solid #d97706; 
            border-radius: 0.6rem;
            padding: 1rem;
            margin-top: 1.5rem;
            color: #d97706;
            font-size: 0.9rem;
            text-align: left;
            max-width: 100%; /* CAMBIO: de 400px a 100% */
            margin-left: auto;
            margin-right: auto;
        }
        
        .warning-box ul {
            list-style: disc;
            padding-left: 1.5rem;
            margin-top: 0.5rem;
        }
        
        .warning-box ul li {
            margin-bottom: 0.25rem;
        }
        
        .buy-button {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            max-width: 100%; /* CAMBIO: de 400px a 100% */
            margin-left: auto;
            margin-right: auto;
            padding: 1rem 1.5rem;
            border-radius: 0.75rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease-in-out;
            text-align: center;
            text-decoration: none;
            box-sizing: border-box;
            margin-top: 1rem;
            white-space: normal;
            word-break: break-word;
            font-size: 1.05rem;
            opacity: 0.6; 
            pointer-events: none; 
            color: var(--text-light);
        }
        
        .buy-button.enabled {
            opacity: 1;
            pointer-events: auto;
        }
        
        .buy-button.mp {
            background-color: var(--mp-color); 
            border: 2px solid var(--mp-color);
        }
        
        .buy-button.mp:hover { 
            background-color: #0077b3; 
            transform: translateY(-2px); 
            box-shadow: var(--shadow-sm); 
        }
        
        .buy-button.disabled-text {
            opacity: 0.8;
            background-color: #e5e7eb !important;
            color: #6b7280 !important;
            border: 2px solid #d1d5db !important;
        }
        
        .buy-button i { 
            margin-right: 0.75rem; 
        }

        .form-group {
            margin-bottom: 1rem;
            text-align: left;
            max-width: 100%; /* CAMBIO: de 400px a 100% */
            margin-left: auto;
            margin-right: auto;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--text-dark);
            font-size: 0.95rem;
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            box-shadow: var(--shadow-sm);
            font-size: 1rem;
            transition: border-color 0.3s;
        }
        
        .form-group input:focus, .form-group select:focus {
            border-color: var(--color-blue);
            outline: none;
            box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.2);
        }
        
        .type-selector {
            display: flex;
            justify-content: center;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
            max-width: 100%; /* CAMBIO: de 400px a 100% */
            margin-left: auto;
            margin-right: auto;
        }
        
        .type-option {
            flex: 1;
            padding: 0.75rem 0.5rem;
            border-radius: 0.5rem;
            border: 2px solid var(--border-color);
            cursor: pointer;
            font-weight: 600;
            color: var(--text-medium);
            transition: all 0.3s ease;
            text-align: center;
            font-size: 0.95rem;
            background-color: #f9fafb;
        }
        
        .type-option.selected {
            background: var(--primary-gradient);
            color: var(--text-light);
            border-color: var(--color-blue);
            box-shadow: var(--shadow-sm);
        }

        #purchaseDetailsSelect {
            max-width: 100%; /* CAMBIO: de 400px a 100% */
            margin-left: auto;
            margin-right: auto;
            text-align: left;
        }
        
        .loading-spinner, .message-container {
            max-width: 100%; /* CAMBIO: de 400px a 100% */
            margin-left: auto;
            margin-right: auto;
            text-align: center;
        }
        
        /* =====================================================================
        ESTILOS DEL LOADING SPINNER
        ===================================================================== */
        .loading-spinner-container {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 2rem 0; 
            height: 100px; 
        }

        .loading-ring-container {
            display: flex;
            justify-content: space-between;
            width: 70px; 
        }

        .loading-ring {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background: var(--primary-gradient);
            animation: bounce 1.4s infinite ease-in-out both;
        }

        .loading-ring:nth-child(1) {
            animation-delay: -0.32s;
        }
        
        .loading-ring:nth-child(2) {
            animation-delay: -0.16s;
        }
        
        .loading-ring:nth-child(3) {
            animation-delay: 0s;
        }

        @keyframes bounce {
            0%, 80%, 100% {
                transform: scale(0);
            }
            40% {
                transform: scale(1.0);
            }
        }
        
        .loading-text {
            color: var(--color-blue);
            font-weight: 600;
            margin-top: 0.5rem;
        }
        
        /* =====================================================================
        ESTILOS DEL MODAL DE √âXITO Y ERROR (TOOLTIP)
        ===================================================================== */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .success-modal-content, .error-modal-content {
            background-color: var(--card-bg);
            border-radius: 1rem;
            padding: 2rem;
            max-width: 90%;
            width: 380px;
            text-align: center;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            transform: scale(0.95);
            opacity: 0;
            transition: all 0.3s ease-out;
        }
        
        .modal-overlay.active .success-modal-content,
        .modal-overlay.active .error-modal-content {
            transform: scale(1);
            opacity: 1;
        }

        .success-modal-content .icon-container {
            width: 80px;
            height: 80px;
            margin: 0 auto 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .success-modal-content h4 {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--color-green);
            margin-bottom: 0.5rem;
        }
        
        .error-modal-content h4 {
            font-size: 1.5rem;
            font-weight: 700;
            color: #dc2626; /* Rojo de error */
            margin-bottom: 0.5rem;
        }

        .success-modal-content p, .error-modal-content p {
            font-size: 1rem;
            color: var(--text-medium);
            margin-bottom: 1.5rem;
            text-align: left;
        }
        
        .success-modal-content p strong {
            color: var(--text-dark);
            font-weight: 600;
        }

        .success-modal-content .btn-close, .error-modal-content .btn-close {
            background-color: var(--color-blue);
            color: var(--text-light);
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .success-modal-content .btn-close:hover, .error-modal-content .btn-close:hover {
            background-color: #1d4ed8;
        }

        /* =====================================================================
        ESTILOS PARA EL FOOTER - FONDO NEGRO S√ìLIDO Y ANCHO COMPLETO
        ===================================================================== */
        .footer-content {
            width: 100%;
            margin-top: 2rem;
            padding: 2rem 1rem;
            box-sizing: border-box;
            text-align: center;
            background-color: #000000 !important;
            border-top: none !important;
            box-shadow: none !important;
            position: relative;
            z-index: 1;
        }
        
        .footer-content h3 {
            font-size: 1.1rem;
            font-weight: 600;
            color: #ffffff;
            border-bottom: none;
            padding-bottom: 0;
            margin-bottom: 0.5rem;
        }
        
        .footer-content .social-icons {
            margin-bottom: 1rem;
        }
        
        .footer-content .social-icons a {
            color: var(--color-blue);
            font-size: 1.8rem;
            margin: 0 0.5rem;
            transition: color 0.3s;
        }
        
        .footer-content .social-icons a:hover {
            color: var(--color-green);
        }
        
        .footer-content p {
            font-size: 0.85rem;
            color: #cccccc;
            line-height: 1.4;
        }
        
        .footer-content a {
            color: var(--color-blue);
            text-decoration: none;
            transition: color 0.3s;
        }
        
        .footer-content a:hover {
            text-decoration: underline;
            color: var(--color-green);
        }
        
        .footer-content strong {
            font-weight: 600;
            color: #ffffff;
        }
        
        .footer-content footer {
            padding: 0; 
        }

        /* =====================================================================
        ESTILOS PARA EL BOT√ìN DE WHATSAPP FLOTANTE
        ===================================================================== */
        .chat-bubble {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            background: linear-gradient(45deg, #25D366, #128C7E); /* Colores de WhatsApp */
            color: white;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 30px;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            animation: slideIn 1s ease-out forwards;
        }

        @keyframes slideIn {
            0% {
                transform: translateX(100%);
                opacity: 0;
            }
            100% {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .chat-bubble:hover {
            background: linear-gradient(45deg, #128C7E, #25D366); /* Invertir colores al pasar el rat√≥n */
        }

        .chat-text {
            position: fixed;
            bottom: 90px;
            right: 20px;
            background: linear-gradient(45deg, #25D366, #128C7E); /* Colores de WhatsApp */
            color: white;
            padding: 12px 18px;
            border-radius: 10px;
            font-size: 15px;
            box-shadow: 0 6px 10px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            white-space: nowrap;
            opacity: 0;
            transform: scale(0.9);
            transition: opacity 0.5s ease, transform 0.5s ease;
            z-index: 1001;
            cursor: pointer;
        }

        .chat-text.show {
            opacity: 1;
            transform: scale(1);
        }

        .chat-text.hide {
            opacity: 0;
            transform: scale(0.9);
        }

        /* =====================================================================
        ESTILOS PARA LOS TOOLTIPS DE AYUDA
        ===================================================================== */
        .help-icon-wrapper {
            position: relative;
            display: inline-block;
            margin-left: 8px;
            cursor: pointer;
        }

        .help-icon {
            width: 18px;
            height: 18px;
            background-color: var(--color-blue);
            color: white;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
            transition: background-color 0.3s;
        }

        .help-icon:hover {
            background-color: var(--color-green);
        }

        /* === √öNICO CAMBIO: POSICIONAMIENTO DEL TOOLTIP (centrado en pantalla, encima del √≠cono) === */
        .tooltip {
            position: fixed;                /* antes: absolute */
            left: 50%;                      /* centrado horizontal en pantalla */
            top: auto;                      /* se calcula por JS */
            right: auto;                    /* antes: right:100% */
            transform: translateX(-50%);    /* centra respecto a left:50% */
            margin: 0;                      /* sin desplazamientos laterales */
            background-color: #1f2937;
            color: white;
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 13px;
            line-height: 1.5;
            width: 280px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
            z-index: 1000;
            pointer-events: none;
        }

        .tooltip::after {
            content: '';
            position: absolute;
            left: 50%;                      /* flecha centrada en el tooltip */
            bottom: -8px;                   /* flecha apuntando hacia abajo (al √≠cono) */
            top: auto;                      /* anula el top anterior */
            right: auto;                    /* anula el right anterior */
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-top: 8px solid #1f2937;  /* tri√°ngulo hacia abajo */
            border-bottom: 0;
        }

        /* Se mantiene el mismo disparador hover, solo cambia la posici√≥n (JS coloca top) */
        .help-icon-wrapper:hover .tooltip {
            opacity: 1;
            visibility: visible;
        }

        /* Responsive para tooltips en pantallas peque√±as */
        @media (max-width: 640px) {
            .tooltip {
                width: 220px;
                font-size: 12px;
                padding: 10px 12px;
            }
        }

        /* Estilo para hacer el campo de ID editable visualmente */
        #userUid.editable {
            color: var(--text-dark) !important;
            background-color: #ffffff !important;
            cursor: text;
        }
    </style>
</head>
<body class="min-h-screen">

    <!-- Diamantes flotantes en el fondo -->
    <div class="diamond"></div>
    <div class="diamond"></div>
    <div class="diamond"></div>
    <div class="diamond"></div>
    <div class="diamond"></div>
    <div class="diamond"></div>
    <div class="diamond"></div>

    <!-- CABECERA (Header) -->
    <header class="px-4 py-3 flex items-center justify-between sticky top-0 z-40 border-b border-gray-100 h-16" style="background-color: #000000;">
        <div class="flex items-center gap-3">
            <!-- Icono de men√∫ -->
            <button id="menu-toggle" class="p-1 active:bg-gray-700 rounded-full transition-colors">
                <i data-lucide="menu" class="header-icon"></i>
            </button>
        </div>
        
        <!-- T√≠tulo central -->
        <div class="flex-1 text-center">
            <h1 class="text-xl font-bold" style="color: #ffffff;">Cr√©ditos y Planes</h1>
        </div>
        
        <div class="flex items-center gap-4">
            <!-- Icono Perfil - Ahora lleva a actividad -->
            <button id="profile-btn" class="p-1 active:bg-gray-700 rounded-full transition-colors">
                <i data-lucide="user" class="header-icon"></i>
            </button>
            <!-- Icono Compartir - Ahora abre el modal -->
            <button id="share-btn" class="p-1 active:bg-gray-700 rounded-full transition-colors">
                <i data-lucide="share-2" class="header-icon"></i>
            </button>
        </div>
    </header>

    <!-- MENU LATERAL (Sidebar) -->
    <div id="sidebar-overlay" class="fixed inset-0 bg-black/50 z-50 hidden opacity-0"></div>
    
    <aside id="sidebar">
        <!-- Encabezado Sidebar -->
        <div class="sidebar-header-bg">
            <!-- Contenedor del icono -->
            <div>
        <img src="https://cdn-icons-png.flaticon.com/128/747/747965.png" alt="Icono masitaprex">
    </div>
    <h1>masitaprex</h1>
        </div>
        <!-- Opciones del Men√∫ Actualizadas -->
        <nav>
            <!-- Nuevas opciones del men√∫ (eliminada la opci√≥n "Inicio") -->
            <a href="home" class="menu-item">
                <i data-lucide="layout-dashboard" class="menu-icon"></i>
                <span class="text-lg">Inicio</span>
            </a>
            
            <a href="api-key" class="menu-item">
                <i data-lucide="terminal-square" class="menu-icon"></i>
                <span class="text-lg">API Key</span>
            </a>
            
            <a href="planes.html" class="menu-item active">
                <i data-lucide="credit-card" class="menu-icon"></i>
                <span class="text-lg">Recargar</span>
            </a>

            <a href="API-Docs" class="menu-item">
                <i data-lucide="file-code-2" class="menu-icon"></i>
                <span class="text-lg">Documentaci√≥n APIs</span>
            </a>

            <a href="PeliPREX" class="menu-item">
                <i data-lucide="clapperboard" class="menu-icon"></i>
                <span class="text-lg">PeliPREX HD gratis</span>
            </a>

            <a href="#" id="logout-btn" class="menu-item">
                <i data-lucide="log-out" class="menu-icon"></i>
                <span class="text-lg">Cerrar sesi√≥n</span>
            </a>
        </nav>
    </aside>

    <!-- CONTENIDO PRINCIPAL (Consulta PE: Precios y Pagos) -->
    <main class="main-content-container">
        
        <!-- Contenido original de "Consulta PE: Precios y Pagos" -->
        <div id="comprarCreditosContainer" class="app-card accent-border">
            <h2>üõí Compra y Activaci√≥n Autom√°tica</h2>
            
            <p class="text-center text-sm mb-3 font-semibold">
                üìú Importante: Antes de comprar, te recomendamos leer la <a href="politica.compras.html" class="text-blue-600 hover:underline">Pol√≠tica de Compras, Cr√©ditos y Reembolsos.</a>
            </p>

            <div class="info-box">
                <p class="font-bold mb-0">
                Selecciona tu tipo de compra y paquete para pagar con Mercado Pago. La activaci√≥n es inmediata al confirmarse el pago.
                </p>
            </div>

            <div id="purchaseForm">
                <div class="form-group">
                    <label>Selecciona el tipo de compra:</label>
                    <div class="type-selector">
                        <div class="type-option selected" id="creditsType" data-type="CREDITOS">
                            <i class="fas fa-coins"></i> Comprar Cr√©ditos
                        </div>
                        <div class="type-option" id="unlimitedType" data-type="ILIMITADO">
                            <i class="fas fa-rocket"></i> Plan Ilimitado
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="userEmail">
                        Tu correo electr√≥nico (para activar la compra):
                        <span class="help-icon-wrapper">
                            <span class="help-icon">?</span>
                            <div class="tooltip">
                                Ingresa los datos correctos. Si deseas recargar tu propia cuenta, deja el correo e ID que aparecen por defecto. Si quieres recargar otra cuenta, reemplaza esos datos por los de la persona correspondiente.
                            </div>
                        </span>
                    </label>
                    <input
                        type="email"
                        id="userEmail"
                        name="userEmail"
                        required
                        placeholder="ejemplo@gmail.com"
                    />
                </div>
                
                <div class="form-group">
                    <label for="userUid">
                        ID de usuario:
                        <span class="help-icon-wrapper">
                            <span class="help-icon">?</span>
                            <div class="tooltip">
                                Ingresa los datos correctos. Si deseas recargar tu propia cuenta, deja el correo e ID que aparecen por defecto. Si quieres recargar otra cuenta, reemplaza esos datos por los de la persona correspondiente.
                            </div>
                        </span>
                    </label>
                    <input
                        type="text"
                        id="userUid"
                        name="userUid"
                        required
                        placeholder="ID de Usuario"
                    />
                </div>

                <div class="form-group">
                <label for="purchaseDetailsSelect" id="selectLabel">Selecciona el Paquete de Cr√©ditos:</label>
                <select id="purchaseDetailsSelect" name="purchaseDetailsSelect" required>
                    <option value="" disabled selected>Selecciona un monto/plan</option>
                </select>
                </div>

                <div class="loading-spinner" id="paymentLoading" style="display: none;">
                    <div class="loading-spinner-container">
                        <div class="loading-ring-container">
                            <div class="loading-ring"></div>
                            <div class="loading-ring"></div>
                            <div class="loading-ring"></div>
                        </div>
                    </div>
                    <p class="loading-text">Iniciando pago, espera un momento...</p>
                </div>
                
                <button type="button" class="buy-button mp" id="mpButton">
                <i class="fas fa-money-check-alt"></i> Pagar con Mercado Pago
                </button>
                
                <div class="message-container" id="paymentMessage" style="display: none;"></div>
            </div>
            
            <p class="text-center mt-4 text-xs text-gray-500">
                ‚ö†Ô∏è Importante: Tu ID de usuario debe estar cargado. Contacta a soporte si ves campos vac√≠os.
            </p>

        </div>
        
        <hr class="w-full border-gray-300 mx-auto" style="border-top-width: 4px; border-style: dotted;"/>

        <div class="app-card">
            <h3 class="text-center"><i class="fas fa-coins text-yellow-600 mr-2"></i> Cr√©ditos para Consultas Individuales</h3>
            
            <p class="text-center text-sm mb-3">
                Elige tu paquete y ahorra m√°s por cada consulta con las bonificaciones.
            </p>

            <table class="pricing-table">
                <thead>
                <tr>
                    <th>Monto (S/.)</th>
                    <th>Cr√©ditos Asignados</th>
                    <th>Bonificaci√≥n Extra</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td>10</td>
                    <td>60 ‚ö°</td>
                    <td>+3 Cr√©ditos</td>
                </tr>
                <tr>
                    <td>20</td>
                    <td>125 üöÄ</td>
                    <td>+5 Cr√©ditos</td>
                </tr>
                <tr class="recommended-row">
                    <td>50</td>
                    <td>330 üíé</td>
                    <td>+20 Cr√©ditos</td>
                </tr>
                <tr>
                    <td>100</td>
                    <td>700 üëë</td>
                    <td>+40 Cr√©ditos</td>
                </tr>
                <tr class="best-value-row">
                    <td>200</td>
                    <td>1500 üî•</td>
                    <td>+80 Cr√©ditos</td>
                </tr>
                </tbody>
            </table>
            
            <p class="text-center mt-4 text-sm font-semibold text-gray-700">
                üí° Recomendaci√≥n: El paquete de S/50 es la opci√≥n m√°s equilibrada.
            </p>
            
            <h3 class="section-subtitle"><i class="fas fa-chart-bar"></i> Comparativa de Ahorro por Paquete</h3>
            
            <table class="pricing-table">
                <thead>
                <tr>
                    <th>Paquete</th>
                    <th>Cr√©ditos</th>
                    <th>Costo / consulta aprox.</th>
                    <th>Ahorro Estimado</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td>S/10</td>
                    <td>60 ‚ö°</td>
                    <td>S/0.17</td>
                    <td>‚Äî</td>
                </tr>
                <tr class="recommended-row">
                    <td>S/50</td>
                    <td>330 üíé</td>
                    <td>S/0.15</td>
                    <td>13%</td>
                </tr>
                <tr class="best-value-row">
                    <td>S/200</td>
                    <td>1500 üî•</td>
                    <td>S/0.13</td>
                    <td>24%</td>
                </tr>
                </tbody>
            </table>
            
            <p class="text-center mt-4 text-sm text-gray-700">
                üß† En resumen: mientras m√°s grande sea tu paquete, menos pagas por consulta y m√°s ahorras a largo plazo.
            </p>

        </div>
        
        <div class="app-card">
            <h3 class="text-center"><i class="fas fa-rocket text-red-600 mr-2"></i> Planes Ilimitados (Acceso Sin L√≠mites)</h3>
            
            <p class="text-center text-sm mb-3">
                Ideal para alto volumen de consultas. Ahorro garantizado por tiempo definido.
            </p>

            <table class="pricing-table">
                <thead>
                <tr>
                    <th>Duraci√≥n</th>
                    <th>Precio sugerido (S/.)</th>
                    <th>Ahorro Estimado</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td>7 d√≠as</td>
                    <td>60</td>
                    <td>+S/4.00</td>
                </tr>
                <tr>
                    <td>15 d√≠as</td>
                    <td>80</td>
                    <td>+S/7.50</td>
                </tr>
                <tr class="recommended-row">
                    <td>30 d√≠as</td>
                    <td>110</td>
                    <td>+S/17.00</td>
                </tr>
                <tr>
                    <td>60 d√≠as</td>
                    <td>160</td>
                    <td>+S/30.00</td>
                </tr>
                <tr class="best-value-row">
                    <td>70 d√≠as</td>
                    <td>510</td>
                    <td>+S/50.00</td>
                </tr>
                </tbody>
            </table>
        </div>
        
        <div class="app-card accent-border">
            <h3 class="text-center"><i class="fas fa-star text-yellow-500 mr-2"></i> Ventajas Exclusivas</h3>
            
            <div class="advantage-list">
                <div class="advantage-item">
                    <i class="fas fa-bolt"></i>
                    <span>Activaci√≥n Inmediata</span>
                </div>
                <div class="advantage-item">
                    <i class="fas fa-shield-alt"></i>
                    <span>Pago 100% Seguro</span>
                </div>
                <div class="advantage-item">
                    <i class="fas fa-headset"></i>
                    <span>Soporte Prioritario</span>
                </div>
                <div class="advantage-item">
                    <i class="fas fa-percent"></i>
                    <span>Bonificaciones Extra</span>
                </div>
            </div>
            
        </div>

        <div class="app-card">
            <h3 class="text-center"><i class="fas fa-clipboard-list text-gray-500 mr-2"></i> Instrucciones para realizar tu pago</h3>
            
            <p class="text-sm mb-4">
                En Consulta PE puedes pagar de forma segura, r√°pida y confiable con Mercado Pago. Elige el m√©todo que prefieras üëá
            </p>
            
            <div class="section-subtitle"><i class="fas fa-credit-card"></i> 1. Pago con Tarjeta de Cr√©dito o D√©bito</div>
            <ul class="instruction-list">
                <li data-step="1">Selecciona "Tarjeta de cr√©dito o d√©bito".</li>
                <li data-step="2">Ingresa los datos solicitados (N√∫mero, Titular, Vencimiento, CVV, Documento).</li>
                <li data-step="3">Verifica que tu banco tenga activa la opci√≥n "Compras por internet".</li>
                <li data-step="4">Presiona "Continuar" para confirmar el pago.</li>
            </ul>
            <p class="text-xs text-gray-500 ml-5">‚è±Ô∏è Tiempo de activaci√≥n: Inmediato. Tu pago se acredita al instante.</p>


            <div class="section-subtitle"><i class="fas fa-university"></i> 2. Pago por Dep√≥sito o Transferencia (PagoEfectivo)</div>
            <p class="text-sm text-gray-700 mb-2">
                Bancos y agentes: BCP, Interbank, BBVA, Scotiabank, BanBif, Kasnet, Tambo, Western Union, Full Carga.
            </p>
            <ul class="instruction-list">
                <li data-step="1">Selecciona tu banco o agente preferido.</li>
                <li data-step="2">Mercado Pago generar√° un c√≥digo CIP.</li>
                <li data-step="3">Realiza el pago desde tu banca o agente usando el c√≥digo CIP.</li>
            </ul>
            <p class="text-xs text-gray-500 ml-5">‚è±Ô∏è Activaci√≥n: 3 horas (BCP, Interbank, Tambo) o hasta 1 d√≠a h√°bil (BBVA, BanBif).</p>


            <div class="section-subtitle" style="color: var(--yape-color);"><i class="fas fa-mobile-alt"></i> 3. Pago con Yape</div>
            <ul class="instruction-list">
                <li data-step="1">Selecciona la opci√≥n "Yape".</li>
                <li data-step="2">Ingresa tu correo electr√≥nico y celular registrado en Yape.</li>
                <li data-step="3">Aseg√∫rate de tener activa la opci√≥n "Compras por internet".</li>
                <li data-step="4">Ingresa los 6 d√≠gitos del c√≥digo de aprobaci√≥n que te muestra la app.</li>
                <li data-step="5">Presiona "Pagar".</li>
            </ul>
            <p class="text-xs text-gray-500 ml-5">‚è±Ô∏è Tiempo de activaci√≥n: Inmediato. Tu pago se acredita al instante.</p>
            <p class="text-center mt-3 text-sm">
                üìò <a href="https://www.yape.com.pe/preguntas-frecuentes/compras-por-internet/como-activo-y-desactivo-mis-compras-por-internet-y-pos-desde-yape" target="_blank" class="text-blue-600 hover:underline font-semibold">Gu√≠a oficial para activar compras por internet en Yape</a>
            </p>

        </div>
        
        <div class="app-card">
            <h3 class="section-subtitle"><i class="fas fa-receipt"></i> Consejos Importantes</h3>
            <div class="warning-box">
                <ul>
                    <li>Usa √∫nicamente tarjetas y cuentas bancarias a tu nombre.</li>
                    <li>Aseg√∫rate de tener saldo disponible antes de pagar.</li>
                    <li>Si tu pago no se acredita de inmediato, espera hasta 1 hora.</li>
                    <li>Si necesitas ayuda, env√≠a tu pantallazo o comprobante al soporte de Consulta PE.</li>
                </ul>
            </div>
            
            <h3 class="section-subtitle"><i class="fas fa-check-circle text-green-600"></i> Activaci√≥n de Compra</h3>
            <div class="text-sm text-gray-700">
                Una vez confirmado tu pago, tu compra (cr√©ditos o plan) se activa autom√°ticamente y podr√°s realizar todas tus consultas sin restricciones. Recibir√°s un correo o mensaje de confirmaci√≥n con el detalle de tu compra.
            </div>
            
            <a href="go:11" class="info-credits-button">
                Todo lo que debes saber acerca de tus cr√©ditos !!
            </a>
            
            <div class="text-center mt-4 text-sm text-gray-500">
                <p>üéØ Nuestra meta: En Consulta PE, queremos que te sientas feliz con tu compra y experimentes una atenci√≥n de calidad superior. Tu satisfacci√≥n nos impulsa a mejorar cada d√≠a.</p>
                <p class="mt-2">‚≠ê Si te gusta nuestro servicio, recomi√©ndanos a tus amigos y familiares.</p>
            </div>
        </div>

    </main>
    
    <!-- FOOTER CON FONDO NEGRO S√ìLIDO Y ANCHO COMPLETO -->
    <div class="footer-content">
        <footer>
            <h3>S√≠guenos en nuestras redes sociales</h3>
            <div class="social-icons">
                <a href="https://m.facebook.com/61564349657272/" target="_blank" aria-label="Facebook"><i class="fab fa-facebook-square"></i></a>
                <a href="https://youtube.com/@eltiojota628?si=sZw2ZHHTUMdaR0nL" target="_blank" aria-label="YouTube"><i class="fab fa-youtube-square"></i></a>
            </div>
            <p class="mb-2">Consulta PE ¬© 2024 - Todos los derechos reservados</p>
            <p class="mb-2">
                <a href="terminos-condiciones">T√©rminos y condiciones</a> |
                <a href="politica-privacidad">Pol√≠tica de privacidad</a> |
                <a href="disclaimer-apis">Aviso legal apis</a> |
                <a href="aviso-legal-peliprex">Avis√≥ legal peliPREX</a> |
                <a href="politica.compras">Pol√≠tica de compras</a>
            </p>
            <p>Esta aplicaci√≥n utiliza servicios de intermediaci√≥n para facilitar el acceso a informaci√≥n p√∫blica. <strong>No somos los propietarios, custodios ni responsables directos de la informaci√≥n o de las APIs de las entidades de origen.</strong></p>
        </footer>
    </div>

    <!-- MODAL DE COMPARTIR -->
    <div class="banner" id="banner">  
        <div class="banner-title"><i class="fas fa-heart banner-icon"></i> ü§≠ ¬°Peque√±o favorcito!</div>  
        <div class="banner-description">  
            <p>Si no es mucho pedir, comparte esta p√°gina con todos tus contactos en Facebook, Messenger y WhatsApp. üì≤</p>  
            <p>Hazlo por la eficiencia, por la facilidad‚Ä¶ o simplemente para apoyar a Consulta PE y seguir mejorando juntos..üòú‚ú®</p>  
        </div>  
        <a href="#" class="cta-button" onclick="sharePage()"><i class="fas fa-share-alt banner-icon"></i> Compartir ahora</a>  
        <a href="#" class="close-modal" onclick="closeBanner()"><i class="fas fa-times banner-icon"></i> Quiz√°s m√°s tarde</a>  
    </div>

    <!-- MODALES DE √âXITO Y ERROR -->
    <div id="successModalOverlay" class="modal-overlay">
        <div class="success-modal-content">
            <div class="icon-container">
                <img src="https://cdn-icons-png.flaticon.com/128/11202/11202612.png" alt="Icono de Activaci√≥n Exitosa" style="width: 80px; height: 80px;">
            </div>
            <h4 id="successModalTitle">Activaci√≥n Exitosa</h4>
            <div id="successModalBody" class="text-gray-700 mb-6 text-sm whitespace-pre-line text-left">
                </div>
            <button class="btn-close" onclick="closeSuccessModal()">¬°Entendido! Volver a Consultar</button>
        </div>
    </div>
    
    <div id="errorModalOverlay" class="modal-overlay">
        <div class="error-modal-content">
            <h4 class="text-lg font-bold mb-4">‚ùå Error en la Transacci√≥n</h4>
            <p id="errorMessage" class="text-gray-700 mb-6 text-sm"></p>
            <button class="btn-close" onclick="closeErrorModal()">Aceptar</button>
        </div>
    </div>

    <!-- BOT√ìN DE WHATSAPP FLOTANTE -->
    <div class="chat-bubble" onclick="goToWhatsApp()">
        <div class="icon">
            <i class="fab fa-whatsapp"></i>
        </div>
    </div>

    <div class="chat-text" id="chatText" onclick="goToWhatsApp()"></div>

    <script>
        // üí° URL BASE DE TU ENDPOINT UNIFICADO (sin el monto final)
        const BASE_API_URL = "/api/init/mercadopago"; 

        // Mapeo de cr√©ditos
        const CREDITS_MAP = {
            "10": { credits: 60 },
            "20": { credits: 125 },
            "50": { credits: 330 },
            "100": { credits: 700 },
            "200": { credits: 1500 },
        };
        
        // Mapeo de planes ilimitados (la clave es la duraci√≥n/descripci√≥n, el valor `amount` es el MONTO DE PAGO)
        const UNLIMITED_MAP = {
            "7-dias": { amount: 60, duration: '7 d√≠as' },
            "15-dias": { amount: 80, duration: '15 d√≠as' },
            "30-dias": { amount: 110, duration: '30 d√≠as' },
            "60-dias": { amount: 160, duration: '60 d√≠as' },
            "70-dias": { amount: 510, duration: '70 d√≠as' },
        };

        let auth;

        // Clave para localStorage
        const STORAGE_KEY_EMAIL = 'masitaprex_user_email';
        const STORAGE_KEY_UID = 'masitaprex_user_uid';

        // === FUNCIONES PARA EL MEN√ö LATERAL ===
        // Inicializar iconos de Lucide
        lucide.createIcons();

        // Control del men√∫ lateral
        const menuToggle = document.getElementById('menu-toggle');
        const sidebar = document.getElementById('sidebar');
        const overlay = document.getElementById('sidebar-overlay');

        function toggleMenu() {
            const isOpen = sidebar.classList.toggle('open');
            if (isOpen) {
                overlay.classList.remove('hidden');
                overlay.style.display = 'block';
                document.body.style.overflow = 'hidden';
                setTimeout(() => overlay.classList.add('opacity-100'), 10);
            } else {
                overlay.classList.remove('opacity-100');
                document.body.style.overflow = '';
                setTimeout(() => {
                    if (!sidebar.classList.contains('open')) {
                        overlay.classList.add('hidden');
                        overlay.style.display = 'none';
                    }
                }, 300);
            }
        }

        menuToggle.addEventListener('click', toggleMenu);
        overlay.addEventListener('click', toggleMenu);

        // Cerrar men√∫ al hacer click en un enlace (excepto cerrar sesi√≥n)
        const navLinks = sidebar.querySelectorAll('nav a:not(#logout-btn)');
        navLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                toggleMenu();
                // Redirigir a la p√°gina correspondiente
                window.location.href = link.getAttribute('href');
            });
        });

        // Bot√≥n de perfil - lleva a actividad
        document.getElementById('profile-btn').addEventListener('click', function() {
            window.location.href = 'actividad.html';
        });

        // Bot√≥n de compartir - abre el modal (NO muestra autom√°ticamente despu√©s de tiempo)
        document.getElementById('share-btn').addEventListener('click', function() {
            document.getElementById('banner').style.display = 'flex';
        });

        // Bot√≥n de cerrar sesi√≥n - cierra sesi√≥n realmente en Firebase
        document.getElementById('logout-btn').addEventListener('click', function(e) {
            e.preventDefault();
            if (confirm('¬øEst√°s seguro de que deseas cerrar sesi√≥n?')) {
                auth.signOut().then(() => {
                    // Limpiar localStorage al cerrar sesi√≥n
                    localStorage.removeItem(STORAGE_KEY_EMAIL);
                    localStorage.removeItem(STORAGE_KEY_UID);
                    alert('Sesi√≥n cerrada correctamente');
                    window.location.href = 'login.html';
                }).catch((error) => {
                    console.error('Error al cerrar sesi√≥n:', error);
                    alert('Error al cerrar sesi√≥n. Intenta nuevamente.');
                });
            }
        });

        // Funciones para el modal de compartir
        // NOTA: EL TIMEOUT DE 50 SEGUNDOS FUE ELIMINADO SEG√öN REQUERIMIENTO
        // El modal solo se muestra cuando se pulsa el √≠cono de compartir

        function sharePage() {  
            const url = "https://masitaprexv2.fly.dev/";  
            const title = "¬øSab√≠as que puedes consultar tu DNI, RUC y m√°s en segundos? Descubre c√≥mo con la app Consulta PE";  
            const text = "¬°Hey! Te recomiendo la app Consulta PE, s√∫per √∫til para consultar tu DNI, RUC, placas y m√°s, todo desde tu m√≥vil. ¬°Pru√©bala!";  

            if (navigator.share) {  
                navigator.share({ title, text, url })  
                    .catch(error => console.log("Error al compartir:", error));  
            } else {  
                window.open(url, "_blank");  
            }  
        }  

        function closeBanner() {  
            document.getElementById('banner').style.display = 'none';  
        }

        // === FUNCIONES PARA LA INTERFAZ DE PRECIOS Y PAGOS ===
        async function initApp() {
            try {
                const response = await fetch('/api/config');
                const config = await response.json();
                
                if (!firebase.apps.length) {
                    firebase.initializeApp(config.firebaseConfig);
                }
                auth = firebase.auth();
                
                // Configurar el observador de autenticaci√≥n despu√©s de inicializar
                auth.onAuthStateChanged((user) => {
                    if (user) {
                        // Cargar datos guardados o usar los del usuario autenticado
                        const savedEmail = localStorage.getItem(STORAGE_KEY_EMAIL);
                        const savedUid = localStorage.getItem(STORAGE_KEY_UID);
                        
                        userEmailInput.value = savedEmail || user.email || "";
                        userUidInput.value = savedUid || user.uid || "ID_NO_DISPONIBLE";
                        
                        // Hacer el campo UID editable
                        userUidInput.removeAttribute('readonly');
                        userUidInput.classList.add('editable');
                        userUidInput.style.color = 'var(--text-dark)';
                        userUidInput.style.backgroundColor = '#ffffff';
                        userUidInput.style.cursor = 'text';
                    } else {
                        const currentPath = window.location.pathname + window.location.search;
                        window.location.href = "login.html?returnTo=" + encodeURIComponent(currentPath);
                    }
                    updatePaymentButtons(); 
                });

                // Inicializar la interfaz
                populateDetailsSelect(currentPurchaseType);
                handlePaymentCallback();
            } catch (error) {
                console.error("Error al cargar la configuraci√≥n:", error);
                showErrorModal("Error al conectar con el servidor de autenticaci√≥n.");
            }
        }

        // === O B T E N C I √ì N   D E   E L E M E N T O S   D E L   D O M ===
        const userEmailInput = document.getElementById("userEmail");
        const userUidInput = document.getElementById("userUid");
        const purchaseDetailsSelect = document.getElementById("purchaseDetailsSelect"); 
        const selectLabel = document.getElementById("selectLabel");
        const paymentLoading = document.getElementById("paymentLoading");
        const mpButton = document.getElementById("mpButton");
        const creditsTypeBtn = document.getElementById("creditsType");
        const unlimitedTypeBtn = document.getElementById("unlimitedType");

        // Elementos del Modal de √âxito
        const successModalOverlay = document.getElementById("successModalOverlay");
        const successModalTitle = document.getElementById("successModalTitle");
        const successModalBody = document.getElementById("successModalBody");
        
        // Elementos del Modal de Error
        const errorModalOverlay = document.getElementById("errorModalOverlay");
        const errorMessageDisplay = document.getElementById("errorMessage");

        let currentPurchaseType = 'CREDITOS'; // Estado inicial

        // === GUARDAR DATOS EN LOCALSTORAGE ===
        // Guardar correo cuando el usuario escribe
        userEmailInput.addEventListener('input', function() {
            localStorage.setItem(STORAGE_KEY_EMAIL, this.value.trim());
            updatePaymentButtons();
        });

        // Guardar UID cuando el usuario escribe
        userUidInput.addEventListener('input', function() {
            localStorage.setItem(STORAGE_KEY_UID, this.value.trim());
            updatePaymentButtons();
        });

        // === F U N C I O N E S   D E   U T I L I D A D ===

        /** Muestra el Modal de Error/Rechazo de Pago */
        function showErrorModal(message) {
            errorMessageDisplay.innerHTML = message.replace(/\n/g, '<br>'); // Permite saltos de l√≠nea
            errorModalOverlay.classList.add('active');
            errorModalOverlay.style.display = "flex"; 
            paymentLoading.style.display = "none"; 
        }

        /** Cierra el Modal de Error/Rechazo de Pago */
        window.closeErrorModal = function() { 
            errorModalOverlay.classList.remove('active');
            setTimeout(() => {
                errorModalOverlay.style.display = "none"; 
                // Limpiar URL para evitar que el modal se muestre en cada recarga
                if (window.location.search.includes('payment/rejected') || window.location.search.includes('payment/error')) {
                    window.history.replaceState({}, document.title, window.location.pathname);
                }
            }, 300);
        }
        
        /** Muestra el Modal de √âxito de Pago y Activaci√≥n */
        function showSuccessModal(title, body) {
            successModalTitle.textContent = title;
            // Reemplazar saltos de l√≠nea por <br> para formatear el texto profesional de Firebase
            successModalBody.innerHTML = body.replace(/\n/g, '<br>');
            successModalOverlay.classList.add('active');
            successModalOverlay.style.display = "flex";
        }

        /** Cierra el Modal de √âxito */
        window.closeSuccessModal = function() {
            successModalOverlay.classList.remove('active');
            setTimeout(() => {
                successModalOverlay.style.display = "none";
                // Limpiar URL para evitar que el modal se muestre en cada recarga
                window.history.replaceState({}, document.title, window.location.pathname);
            }, 300);
        }
        
        /**
         * Rellena el SELECT de montos/planes basado en el tipo de compra seleccionado.
         */
        function populateDetailsSelect(type) {
            purchaseDetailsSelect.innerHTML = '<option value="" disabled selected>Selecciona un monto/plan</option>';
            
            let map = {};
            let labelText = '';
            
            if (type === 'CREDITOS') {
                map = CREDITS_MAP;
                labelText = 'Selecciona el Paquete de Cr√©ditos:';
                
                for (const amount in map) {
                    const data = map[amount];
                    const option = document.createElement('option');
                    option.value = amount; 
                    option.textContent = `S/ ${amount}.00 (${data.credits} cr√©ditos)`;
                    purchaseDetailsSelect.appendChild(option);
                }
            } else if (type === 'ILIMITADO') {
                map = UNLIMITED_MAP;
                labelText = 'Selecciona el Plan Ilimitado:';
                
                for (const key in map) {
                    const data = map[key];
                    const option = document.createElement('option');
                    option.value = key; 
                    option.textContent = `${data.duration} por S/ ${data.amount}.00`;
                    purchaseDetailsSelect.appendChild(option);
                }
            }
            
            selectLabel.textContent = labelText;
            updatePaymentButtons();
        }


        /**
         * Habilita/deshabilita el bot√≥n de Mercado Pago y actualiza su texto.
         */
        function updatePaymentButtons() {
            const selectedValue = purchaseDetailsSelect.value;
            const email = userEmailInput.value.trim();
            const uid = userUidInput.value.trim();
            
            mpButton.disabled = true;
            mpButton.classList.remove('enabled');
            mpButton.classList.add('disabled-text');

            if (!email || uid === "Debes Iniciar Sesi√≥n" || !uid || uid === "ID_NO_DISPONIBLE") {
                const msg = '<i class="fas fa-sign-in-alt"></i> Debes Iniciar Sesi√≥n para Pagar';
                mpButton.innerHTML = msg;
                return;
            }

            if (!selectedValue) {
                const msg = '<i class="fas fa-hand-pointer"></i> Selecciona un monto/plan';
                mpButton.innerHTML = msg;
                return;
            }
            
            let amount = 0;
            let purchaseDescription = '';

            if (currentPurchaseType === 'CREDITOS') {
                amount = selectedValue;
                const data = CREDITS_MAP[selectedValue];
                purchaseDescription = `${data.credits} Cr√©ditos`;
            } else if (currentPurchaseType === 'ILIMITADO') {
                const data = UNLIMITED_MAP[selectedValue];
                amount = data.amount; 
                purchaseDescription = `Plan ${data.duration}`;
            }
            
            mpButton.disabled = false;
            mpButton.classList.add('enabled');
            mpButton.classList.remove('disabled-text');
            mpButton.innerHTML = `Pagar S/ ${amount}.00 (${purchaseDescription}) `;
        }
        
        /**
         * Inicia el proceso de pago al servidor.
         */
        async function startPayment() {
            const selectedValue = purchaseDetailsSelect.value;
            const email = userEmailInput.value.trim();
            const uid = userUidInput.value.trim();

            if (!selectedValue || !email || !uid || uid === "Debes Iniciar Sesi√≥n" || uid === "ID_NO_DISPONIBLE") {
                showErrorModal("Por favor, inicia sesi√≥n y selecciona un paquete v√°lido.");
                return;
            }
            
            // Guardar los datos antes de proceder al pago
            localStorage.setItem(STORAGE_KEY_EMAIL, email);
            localStorage.setItem(STORAGE_KEY_UID, uid);
            
            let amount = 0;
            if (currentPurchaseType === 'CREDITOS') {
                amount = selectedValue; 
            } else if (currentPurchaseType === 'ILIMITADO') {
                amount = UNLIMITED_MAP[selectedValue].amount; 
            } else {
                showErrorModal("Tipo de compra no v√°lido.");
                return;
            }

            let description = "";
            if (currentPurchaseType === 'CREDITOS') {
                description = `${CREDITS_MAP[selectedValue].credits} Cr√©ditos`;
            } else {
                description = `Plan ${UNLIMITED_MAP[selectedValue].duration}`;
            }

            const checkoutUrl = `/checkout.html?amount=${amount}&uid=${uid}&email=${email}&description=${encodeURIComponent(description)}`;
            window.location.href = checkoutUrl;
        }
        
        // === LIMPIAR LOCALSTORAGE DESPU√âS DEL PAGO ===
        // Esta funci√≥n se llama cuando el pago se completa exitosamente
        function clearStorageAfterPayment() {
            localStorage.removeItem(STORAGE_KEY_EMAIL);
            localStorage.removeItem(STORAGE_KEY_UID);
        }

        // === GESTI√ìN DEL SELECTOR DE TIPO DE COMPRA (CR√âDITOS/ILIMITADO) ===
        function handleTypeSelection(event) {
            const selectedType = event.currentTarget.dataset.type;
            
            // Actualizar la clase de los botones
            creditsTypeBtn.classList.remove('selected');
            unlimitedTypeBtn.classList.remove('selected');
            event.currentTarget.classList.add('selected');

            // Actualizar el estado y repoblar el select
            currentPurchaseType = selectedType;
            populateDetailsSelect(selectedType);
        }
        
        // === M A N E J O   D E L   C A L L B A C K   D E   P A G O ===
        function handlePaymentCallback() {
            const urlParams = new URLSearchParams(window.location.search);
            const urlPath = window.location.pathname;

            // 1. Manejar √âxito (Redirecci√≥n desde /api/mercadopago?msg=...)
            if (urlPath.endsWith('/payment/success') && urlParams.has('msg')) {
                try {
                    const encodedMsg = urlParams.get('msg');
                    const decodedMsg = decodeURIComponent(encodedMsg);
                    const messageObj = JSON.parse(decodedMsg);
                    
                    if (messageObj && messageObj.titulo && messageObj.cuerpo) {
                        showSuccessModal(messageObj.titulo, messageObj.cuerpo);
                        // Limpiar localStorage despu√©s del pago exitoso
                        clearStorageAfterPayment();
                    } else {
                        showErrorModal("Compra exitosa, pero el mensaje de confirmaci√≥n del servidor est√° incompleto. Por favor, revisa tus cr√©ditos.");
                    }
                } catch (e) {
                    console.error("Error al procesar el mensaje de √©xito:", e);
                    showErrorModal("Error al leer la confirmaci√≥n del servidor. Por favor, revisa tus cr√©ditos.");
                }
                return true;
            }

            // 2. Manejar Error/Rechazo (Redirecci√≥n a /payment/rejected o /payment/error)
            if (urlPath.endsWith('/payment/rejected')) {
                const status = urlParams.get('status') || 'desconocido';
                showErrorModal(`¬°Transacci√≥n Rechazada! Mercado Pago no pudo aprobar el pago. Estado: ${status.toUpperCase()}. Intenta de nuevo o cambia de medio de pago.`);
                return true;
            }
            
            if (urlPath.endsWith('/payment/error') && urlParams.has('msg')) {
                const errorMsg = urlParams.get('msg');
                const decodedErrorMsg = decodeURIComponent(errorMsg);
                showErrorModal(`Error de Activaci√≥n. Por favor, contacta a soporte con el siguiente detalle: \n\n ${decodedErrorMsg}`);
                return true;
            }
            
            return false;
        }


        // === EVENTOS PARA LA INTERFAZ DE PRECIOS Y PAGOS ===
        purchaseDetailsSelect.addEventListener('change', updatePaymentButtons);
        mpButton.addEventListener('click', startPayment);
        
        creditsTypeBtn.addEventListener('click', handleTypeSelection);
        unlimitedTypeBtn.addEventListener('click', handleTypeSelection);

        // === FUNCIONES PARA EL BOT√ìN DE WHATSAPP FLOTANTE ===
        const whatsappMessage = "¬°Comprar creditos por Whatsapp!";
        const chatText = document.getElementById("chatText");
        let index = 0;

        function typeWriter() {
            if (index < whatsappMessage.length) {
                chatText.textContent += whatsappMessage.charAt(index);
                index++;
                setTimeout(typeWriter, 100);
            } else {
                setTimeout(() => {
                    chatText.classList.remove('show');
                    chatText.classList.add('hide');
                    setTimeout(resetAndRestart, 1000);
                }, 2500);
            }
        }

        function resetAndRestart() {
            chatText.textContent = "";
            index = 0;
            chatText.classList.remove('hide');
            setTimeout(() => {
                chatText.classList.add('show');
                typeWriter();
            }, 500);
        }

        function goToWhatsApp() {
            const phoneNumber = '51944950234';
            const prefilledMessage = encodeURIComponent('Hola, necesito ayuda para comprar cr√©ditos para Consulta PE.');
            window.open(`https://wa.me/${phoneNumber}?text=${prefilledMessage}`, '_blank');
        }

        /* === √öNICO CAMBIO: l√≥gica para posicionar el tooltip centrado en pantalla y encima del √≠cono === */
        (function setupCenteredTooltips() {
            function positionTooltip(wrapper) {
                const tooltip = wrapper.querySelector('.tooltip');
                const icon = wrapper.querySelector('.help-icon');
                if (!tooltip || !icon) return;

                // Medimos el √≠cono (elemento ancla)
                const r = icon.getBoundingClientRect();

                // Separaci√≥n vertical entre tooltip y el √≠cono
                const gap = 12;

                // Colocar el tooltip encima del √≠cono
                // (top = parte superior del tooltip)
                const tooltipHeight = tooltip.offsetHeight || 0;
                let top = (r.top - gap - tooltipHeight);

                // Si no hay espacio arriba, lo mantenemos dentro de viewport (sin cambiar el dise√±o general)
                const minTop = 8;
                if (top < minTop) top = minTop;

                tooltip.style.top = top + 'px';

                // Flecha: que apunte al centro horizontal del √≠cono (pero dentro del tooltip)
                const tooltipRect = tooltip.getBoundingClientRect();
                const iconCenterX = r.left + (r.width / 2);
                const arrowLeft = Math.max(12, Math.min(tooltipRect.width - 12, iconCenterX - tooltipRect.left));
                tooltip.style.setProperty('--arrow-left', arrowLeft + 'px');
            }

            // Ajuste fino: usamos una variable CSS solo para mover la flecha (sin tocar nada m√°s)
            const style = document.createElement('style');
            style.textContent = `
                .tooltip::after { left: var(--arrow-left, 50%); }
            `;
            document.head.appendChild(style);

            document.querySelectorAll('.help-icon-wrapper').forEach(wrapper => {
                wrapper.addEventListener('mouseenter', () => positionTooltip(wrapper));
                wrapper.addEventListener('touchstart', () => positionTooltip(wrapper), { passive: true });
            });

            window.addEventListener('scroll', () => {
                document.querySelectorAll('.help-icon-wrapper:hover').forEach(positionTooltip);
            }, { passive: true });

            window.addEventListener('resize', () => {
                document.querySelectorAll('.help-icon-wrapper:hover').forEach(positionTooltip);
            });
        })();

        // === INICIALIZACI√ìN COMPLETA ===
        document.addEventListener("DOMContentLoaded", () => {
            initApp();
            
            // Inicializar el bot√≥n de WhatsApp
            setTimeout(() => {
                chatText.classList.add('show');
                typeWriter();
            }, 1000);
        });
    </script>
</body>
</html>
